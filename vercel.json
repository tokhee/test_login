{
  "version": 2,
  "builds": [
    {
      "src": "config.ru",
      "use": "@vercel/ruby",
      "config": {
        "bundle": true,
        "includeFiles": [
          "config/**/*",
          "app/**/*",
          "db/**/*",
          "public/**/*",
          "Gemfile",
          "Gemfile.lock",
          "config.ru",
          "Rakefile"
        ],
        "buildCommand": "apt-get update && apt-get install -y postgresql-client libpq-dev libyaml-dev && bundle config build.pg --with-pg-config=/usr/bin/pg_config && bundle config build.psych --with-libyaml-dir=/usr/lib && bundle install"
      }
    }
  ],
  "routes": [
    {
      "src": "/(.*)",
      "dest": "config.ru"
    }
  ],
  "env": {
    "RAILS_ENV": "production",
    "RACK_ENV": "production",
    "BUNDLE_DEPLOYMENT": "1",
    "BUNDLE_WITHOUT": "development:test",
    "PORT": "3000"
  }
} 